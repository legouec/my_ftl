/*
** game_turns.c for  in 
** 
** Made by LEGOUEST Clement
** Login   <legoue_c@etna-alternance.net>
** 
** Started on  Wed Nov  8 18:56:25 2017 LEGOUEST Clement
** Last update Wed Nov  8 19:11:16 2017 LEGOUEST Clement
*/

#include "ftl.h"
#include "my_string.h"
#include "system_repair.h"
#include <libmy.h>
#include <stdlib.h>

static const t_game_turns	GAME_TURNS[] = {
  {"attack", &attack},
  {"detect", &detect},
  {"jump", &jump},
  {"get_bonus", &get_bonus},
  {"repair_system", &repair_system},
  {"control_system", &control_panel},
  {"stat", &stat},
  {NULL, NULL}};

void	jump(t_ship *ship)
{
  my_putstr("Initialisation du saut hyperespace.\n");
  ship->navigation_tools->sector += 1;
  ship->ftl_drive->energy -= 1;
  my_putstr("Vous avez atteint un nouveau secteur.\n");
}

void	game_turns(t_ship *ship)
{
  char	*cmd;
  int	idx;

  idx = 0;
  my_putstr("Veuillez entrer une commande de navigation :\n");
  cmd = readline();
  if (cmd == NULL)
    {
      my_putstr("[SYSTEM FAILURE] : le lecteur de commandes est bloque.\n");
    }
  while (GAME_TURN[idx].game_turns != NULL)
    {
      if (my_strcmp(cmd, GAME_TURN[idx].game_turns))
	{
	  GAME_TURN[idx].game_turns(ship);
	  return;
	}
      idx ++;
    }
  my_putstr("[SYSTEM FAILURE] : commande inconnue.\n");
}
